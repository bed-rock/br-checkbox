<dom-module id="br-checkbox">

<template>
	<div class="form_field">
		<input type="checkbox" id$="{{brId}}" on-click="_validate" required$="{{required}}" checked$="{{checked}}">
		<label for$="{{brId}}">{{label}}</label>
		<template is="dom-if" if="{{hasError}}">
			<p class="form_field--error">{{errorMessage}}</p>
		</template>
	</div>
</template>


<script>
	Polymer({
		is: 'br-checkbox',

		properties: {
			label: String,
			brId: String,
			model: {
				type: String,
				reflectToAttribute: true,
				value: 'false',
				observer: '_modelChanged'
			},
			inline: Boolean,
			checked: Boolean,
			required: Boolean,
			errorMessage: String,
		},

		ready: function () {

			this.hasError = false;

			if(this.required)
				this.isValidForm = false;
			else
				this.isValidForm = true;

			var formField = this.$$('.form_field');

			formField.classList.add('checkbox');

			if ( this.required && this.errorMessage ) {
				formField.classList.add('is-invalid');
				this.hasError = true;
			}
			else if ( this.hasAttribute('is-invalid') ) {
				formField.classList.remove('is-invalid');
				this.hasError = false;
			}
		},

		_validate: function(event){

			var formField = this.$$('.form_field');

			if (this.required)
				formField.classList.toggle('is-invalid');
			else
				this.isValidForm = true;

			this.model = event.target.checked.toString();
		},

		_modelChanged: function () {
			if (this.model == 'true') {
				this.checked = true;
				this.isValidForm = true;
			}
			else {
				if (this.required)
					this.isValidForm = false;
			}
		}

	});
</script>

</dom-module>